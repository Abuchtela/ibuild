# ibuild

`ibuild` is a build system for iOS libraries that are built without using Xcode, using systems like CMake or Make.

A typical workflow for using `ibuild` is as follows:
1. Create a `build.plist` file in the root of your repo.
2. Add a list of static libraries to build to the `build.plist`.
3. Add an "External Build System" target to your Xcode project, pointing to the `ibuild` binary.

With those things set up, when building with Xcode, `ibuild` will ensure that all of the dependencies in your `build.plist` are built.

# Packages you can depend on
If a package has defined a `build.plist` in its root, it can be depended on simply by adding it to the `dependencies` array in your `build.plist`. Some packages include:
- [libgit2-ios](https://github.com/IMcD23/libgit2-ios)
- [openssl-ios](https://github.com/IMcD23/openssl-ios)
- [libssh2-ios](https://github.com/IMcD23/libssh2-ios)
- [libcurl-ios](https://github.com/IMcD23/libcurl-ios)

If you want to build another package that doesn't have a `build.plist`, you must create one for the project. Follow the example of the projects above.

# Things left to implement
- [ ] Check out a specific branch/tag based on `branch` property of a library
- [ ] Refactor `build.plist` to place build settings inside of the library property
- [ ] Support building different branches of the same library
- [ ] Gracefully handle different variants of GitHub URLs for libraries & dependencies (ssh, http, https)

# build.plist files

Below is the schema for a `build.plist` file. A question mark represents an optional property.

```
{
    # Display name of the package
    name: String

    # GitHub URL of this package
    url: String

    # The library that this package builds/exports
    library?: {
        url: String
        branch: String
    }

    # Dependencies of this package
    dependencies: [
        {
            # GitHub URL of the pacakge
            url: String

            # Branch to check out
            branch: String
        }
    ]

    # Names of the libraries that are generated by
    # the build of the `library` property
    libraryOutputs?: [String]

    # The build sytem to use when building.
    # Values: none / cmake / make / xcode
    buildSystem: String

    # Arguments to pass when configuring / building
    buildArgs?: [String]

    # Additional arguments to pass, that depend on
    # platform and architecture
    buildArchSpecificArgs?: {
        <platform>: {
            <arch>: [String]
        }
    }

    # When building a `make` project, this command will
    # replace the `install` in `make install`.
    # Has no effect with other build systems
    installCommand?: String

    # Relative path of a modulemap, which will be copied
    # into the build directory during the build
    modulemap?: String
}
```